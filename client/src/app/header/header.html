<header class="w-full h-14 bg-primary text-secondary flex items-center justify-between px-4 shadow-md relative z-50">
  <!-- Toggle sidebar button -->
  <button
    (click)="onToggleClick()"
    aria-label="Toggle sidebar"
    class="p-2 rounded-md hover:bg-secondary/20"
    title="Toggle sidebar"
  >
    â˜°
  </button>

  <h1 class="font-title text-lg font-bold text-secondary">AI Chat Service</h1>

  <div class="relative">
    <ng-container *ngIf="(user$ | async) as user; else guest">
      <!-- Logged in -->
      <button (click)="showDropdown = !showDropdown" class="px-3 py-1 rounded hover:bg-secondary/20">
        {{ user.username }}
      </button>

      <!-- Dropdown menu -->
      <div
        *ngIf="showDropdown"
        class="absolute right-0 mt-2 w-40 bg-secondary text-accent rounded shadow-lg z-[100]"
      >
        <button
          (click)="logout()"
          class="block w-full text-left px-4 py-2 hover:bg-background/40"
        >
          Logout
        </button>
        <button
          (click)="showDeleteConfirm()"
          class="block w-full text-left px-4 py-2 hover:bg-background/40 text-red-600"
        >
          Delete Account
        </button>
      </div>
    </ng-container>

    <!-- Guest -->
    <ng-template #guest>
      <button
        (click)="toggleAuthDialog()"
        class="px-3 py-1 rounded bg-secondary text-accent hover:bg-secondary/80"
      >
        Login / Sign Up
      </button>
    </ng-template>
  </div>

  <!-- Auth dialog -->
  <app-auth-dialog
    *ngIf="showAuthDialog"
    (close)="toggleAuthDialog()"
  ></app-auth-dialog>

  <!-- Delete confirmation dialog -->
  <div *ngIf="showDeleteDialog" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[101]">
    <div class="bg-secondary p-6 rounded-lg shadow-xl max-w-md">
      <h2 class="text-xl font-bold mb-4 text-accent">Delete Account</h2>
      <p class="mb-4 text-accent">Are you sure you want to delete your account? This action cannot be undone and will delete all your conversations.</p>
      <div class="flex gap-2 justify-end">
        <button
          (click)="cancelDelete()"
          class="px-4 py-2 rounded bg-primary hover:bg-primary/80"
        >
          Cancel
        </button>
        <button
          (click)="confirmDelete()"
          class="px-4 py-2 rounded bg-red-600 text-white hover:bg-red-700"
        >
          Delete
        </button>
      </div>
    </div>
  </div>
</header>